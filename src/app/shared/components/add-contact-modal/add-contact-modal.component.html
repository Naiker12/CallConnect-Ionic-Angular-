<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()" fill="clear">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Agregar contacto</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding-horizontal">
  <div class="header-background"></div>
  
  <div class="content-wrapper">
    <div class="avatar-section">
      <div class="avatar-wrapper">
        <img 
          [src]="userPhotoPreview || 'assets/icon/user-default.png'" 
          alt="Foto de perfil" 
          class="user-avatar"
        >
        <ion-button fill="clear" class="avatar-button" (click)="changePhoto()">
          <ion-icon name="camera" slot="icon-only"></ion-icon>
        </ion-button>
        <div class="avatar-label">Foto de perfil</div>
      </div>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="contact-form">
      <ion-list lines="none" class="form-fields">
        <ion-item class="form-item">
          <ion-label position="stacked">Nombre completo</ion-label>
          <ion-input
            type="text"
            formControlName="nombre"
            [class.invalid]="form.get('nombre')?.invalid && form.get('nombre')?.touched"
          ></ion-input>
          <ion-note slot="error" *ngIf="form.get('nombre')?.invalid && form.get('nombre')?.touched">
            El nombre es requerido (mínimo 2 caracteres)
          </ion-note>
        </ion-item>

        <ion-item class="form-item">
          <ion-label position="stacked">Número de celular</ion-label>
          <ion-input
            type="tel"
            formControlName="telefono"
            inputmode="numeric"
            [class.invalid]="form.get('telefono')?.invalid && form.get('telefono')?.touched"
          ></ion-input>
          <ion-note slot="error" *ngIf="form.get('telefono')?.invalid && form.get('telefono')?.touched">
            El número debe tener 10 dígitos
          </ion-note>
        </ion-item>

        <ion-button 
          expand="block" 
          type="submit" 
          [disabled]="form.invalid || isSubmitting"
          class="submit-button"
        >
          <ion-spinner *ngIf="isSubmitting" name="lines"></ion-spinner>
          <span *ngIf="!isSubmitting">AGREGAR CONTACTO</span>
        </ion-button>
      </ion-list>
    </form>
  </div>
</ion-content>